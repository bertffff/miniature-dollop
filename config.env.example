#===============================================================================
#
#          FILE: config.env
#
#   DESCRIPTION: Configuration for Marzban Ultimate VPN Installer
#                Copy this file to config.env and edit values as needed
#
#         USAGE: cp config.env.example config.env && nano config.env
#
#===============================================================================

#-------------------------------------------------------------------------------
# Domain Configuration
#-------------------------------------------------------------------------------

# Your domain for the Marzban panel (Required)
# This domain must point to your server's IP address
# Example: panel.example.com, vpn.mydomain.org
PANEL_DOMAIN="panel.example.com"

# Reality destination domain (for SNI camouflage)
# This is the website shown during TLS handshake for censorship evasion
# Choose a popular website that supports TLS 1.3
# Recommended: www.google.com, www.microsoft.com, www.apple.com
REALITY_DEST="www.google.com"

# Reality server names (SNI values that Xray will accept)
# Comma-separated list of domains
REALITY_SERVER_NAMES="www.google.com,google.com"

#-------------------------------------------------------------------------------
# Admin Configuration
#-------------------------------------------------------------------------------

# Email address for SSL certificate notifications
# Required for Let's Encrypt certificate registration
ADMIN_EMAIL="admin1@gmail.com"

# Marzban admin panel username
ADMIN_USERNAME="admin"

# Marzban admin panel password
# Leave empty to auto-generate a secure password (recommended)
# Minimum 12 characters recommended
ADMIN_PASSWORD=""

#-------------------------------------------------------------------------------
# Database Configuration
#-------------------------------------------------------------------------------

# Database type: sqlite or mariadb
# SQLite: Simple, low resource usage, good for single server (recommended)
# MariaDB: Better for high traffic, multiple servers, enterprise use
DATABASE_TYPE="sqlite"

# MariaDB settings (only if DATABASE_TYPE="mariadb")
# Leave empty to auto-generate
MARIADB_ROOT_PASSWORD=""
MARIADB_PASSWORD=""
MARIADB_DATABASE="marzban"
MARIADB_USER="marzban"

#-------------------------------------------------------------------------------
# Port Configuration
#-------------------------------------------------------------------------------

# Internal Marzban dashboard port (behind Nginx)
# External access is via port 443 through Nginx SNI routing
MARZBAN_PORT="8000"

# Dashboard URL path (for security through obscurity)
# Example: /dashboard/, /admin/, /SECRET_PATH/
# Must start and end with /
DASHBOARD_PATH="/dashboard/"

# Xray Reality ports (internal, behind Nginx)
# Profile 1: Whitelist mode (restricted traffic)
XRAY_REALITY_PORT_1="8443"
XRAY_REALITY_SNI_1="www.google.com"
XRAY_PROFILE_NAME_1="Reality-Whitelist"

# Profile 2: Standard mode (all traffic)
XRAY_REALITY_PORT_2="8444"
XRAY_REALITY_SNI_2="www.microsoft.com"
XRAY_PROFILE_NAME_2="Reality-Standard"

# Profile 3: WARP mode (via Cloudflare for geo-restricted content)
XRAY_REALITY_PORT_3="8445"
XRAY_REALITY_SNI_3="www.apple.com"
XRAY_PROFILE_NAME_3="Reality-WARP"

#-------------------------------------------------------------------------------
# Feature Flags
#-------------------------------------------------------------------------------

# Install XanMod kernel for better network performance (BBRv3)
# Requires system reboot after installation
# Default: true
INSTALL_XANMOD="true"

# Install Cloudflare WARP for bypassing geo-restrictions
# Enables routing specific traffic (OpenAI, Netflix, etc.) through WARP
# Default: true
INSTALL_WARP="true"

# WARP+ license key (optional, leave empty for free tier)
# Get from: https://t.me/warpplus
WARP_LICENSE=""

# Install AdGuard Home for DNS filtering
# Provides ad-blocking DNS server for clients
# Default: false
INSTALL_ADGUARD="false"

# AdGuard web interface port
ADGUARD_WEB_PORT="3000"

# AdGuard admin credentials (leave empty to auto-generate)
ADGUARD_ADMIN_USER="admin"
ADGUARD_ADMIN_PASS=""

# Install fake website for camouflage
# Serves a legitimate-looking website when accessed without correct SNI
# Default: true
INSTALL_FAKE_SITE="true"

# Custom fake site URL (optional)
# Leave empty for random template selection
FAKE_SITE_URL=""

# Install Fail2Ban for SSH brute-force protection
# Automatically bans IPs after failed SSH login attempts
# Default: true
INSTALL_FAIL2BAN="true"

#-------------------------------------------------------------------------------
# SSL Configuration
#-------------------------------------------------------------------------------

# Use Let's Encrypt staging environment
# Set to true for testing to avoid rate limits
# Set to false for production (real certificates)
# Default: false
USE_STAGING="false"

#-------------------------------------------------------------------------------
# Advanced Configuration
#-------------------------------------------------------------------------------

# Xray log level: none, error, warning, info, debug
XRAY_LOG_LEVEL="warning"

# Enable BBR congestion control
# Highly recommended for better VPN performance
ENABLE_BBR="true"

# Network mode for Docker containers
# host: Better performance, recommended for single server
# bridge: Better isolation, needed for multi-container setups
NETWORK_MODE="host"

# Timezone for containers
TZ="UTC"

# Whitelist Cloudflare IPs in firewall
# Enable if using Cloudflare CDN in front of your server
WHITELIST_CLOUDFLARE="false"

# Skip system update during installation
# Not recommended unless you know what you're doing
SKIP_SYSTEM_UPDATE="false"

# Non-interactive mode (skip all confirmations)
# Useful for automated deployments
NON_INTERACTIVE="false"

# Debug mode (verbose output)
DEBUG_MODE="false"

#===============================================================================
# NOTES:
#
# 1. This file contains sensitive information. Keep it secure!
#    chmod 600 config.env
#
# 2. After installation, credentials are saved to:
#    /opt/marzban/admin_credentials.txt
#
# 3. Reality keys are saved to:
#    /var/lib/marzban/reality_keys.txt
#
# 4. To regenerate configuration, delete config.env and run install.sh again
#
# 5. For troubleshooting, check:
#    - /var/log/marzban-installer.log
#    - docker logs marzban
#    - journalctl -u nginx
#
#===============================================================================
